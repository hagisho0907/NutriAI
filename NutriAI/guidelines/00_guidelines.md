# NutriAI 設計書ドキュメント

このディレクトリには、NutriAIプロジェクトの各種設計書が含まれています。

## ドキュメント一覧

1. [要件定義書](./01_requirements.md) - プロジェクト概要、ターゲット、ユースケース、機能要件
2. [画面設計書](./02_screen_design.md) - 画面一覧、UI仕様、画面遷移図
3. [コンポーネント設計書](./03_component_design.md) - コンポーネント構成、レイヤー別役割
4. [DB設計書](./04_database_design.md) - テーブル定義、ER図、インデックス設計
5. [機能一覧](./05_features_list.md) - MVP機能一覧、トレーサビリティマップ
6. [機能詳細設計書](./06_features_detail.md) - 各機能の処理フロー、データ連携
7. [システム構成図](./07_system_architecture.md) - インフラ、データフロー、セキュリティ
8. [API設計書](./08_api_design.md) - エンドポイント定義、認証、エラーハンドリング
9. [Claude Subagents設計書](./99_subagents.md) - Claude Code向けSubagentの役割定義と運用指針

## 読む順序の推奨

初めてプロジェクトに参画する場合：
1. 要件定義書 → プロジェクト全体を理解
2. 画面設計書 → UIの全体像を把握
3. 機能一覧 → 実装すべき機能を確認
4. その他の設計書 → 担当領域に応じて参照

## 更新方針

設計書の更新は以下のルールに従います：

1. **機能追加・変更時は関連する設計書を同時に更新**
   - 例: 画面変更 → 02_screen_design.md と 06_features_detail.md を更新
   - 例: データ構造変更 → 04_database_design.md を更新
2. **Guidelines.mdと個別ファイルの両方を最新に保つ**
   - Guidelines.mdの変更履歴セクションに要約を記録
   - 個別ファイルに詳細な変更内容を反映
3. **変更履歴の記録方法**
   - Guidelines.mdの最下部「変更履歴」セクションに追記
   - 個別ファイルには該当セクションに「(YYYY-MM-DD更新)」などの注記を追加
   - このREADME.mdの更新履歴セクションに主要変更を記録

## 更新履歴

### 2025-10-19 (最新)
**UI全体のボタンデザイン統一と分析画面のヘッダー改善**

#### 更新された設計書
- `02_screen_design.md`: UI共通仕様（ボタン）、SCR-07（進捗・分析）
- 実装ファイル: `MealLogPage.tsx`, `ExerciseLogPage.tsx`, `AnalyticsPage.tsx`

#### 主な変更内容
1. **「+ 追加」ボタンのホバー効果の統一**
   - 食事記録ページ（MealLogPage）と運動記録ページ（ExerciseLogPage）の「+ 追加」ボタンのホバー時の効果を統一
   - 従来の緑色の背景ホバー効果（`hover:text-accent`）を削除
   - 文字を少し太くする控えめな効果（`hover:font-semibold`）に変更
   - `hover:bg-transparent`で背景色変化をなくし、洗練されたデザインに改善
   - より統一感のある一貫したUIデザインを実現

2. **分析画面のヘッダー改善**
   - ヘッダーに説明文「体重・体組成の推移と目標達成度を確認」を追加
   - チャットタブと同様のスタイルに統一し、画面の目的が一目でわかるように改善

**マイミール・マイフード機能の統合と表記統一**

#### 更新された設計書
- `02_screen_design.md`: SCR-03（ホームダッシュボード）、SCR-04（食事記録）
- `06_features_detail.md`: F-03B（マイフード）、F-03C（マイミール）
- 実装ファイル: `DashboardPage.tsx`, `FoodSelectionPage.tsx`, `MealCreateEditPage.tsx`, `App.tsx`

#### 主な変更内容
1. **マイミール・マイフード機能の統合**
   - ホームダッシュボードのマイミール・マイフードのクイックアクションボタンを削除
   - 機能をFoodSelectionPage（食事記録画面）のタブに統合
   - マイミールタブ: 食事作成・編集・削除機能を完全統合（MealCreateEditPageへの遷移含む）
   - マイフードタブ: 食品登録・編集・削除機能を完全統合（ダイアログUI）
   - App.tsxから不要なmy-meals、my-foodsページルートを削除

2. **表記の統一**
   - 「脂肪」→「脂質」に全画面で統一
   - MealCreateEditPage内の栄養素表記を更新

3. **UIの改善**
   - FoodSelectionPageのタブデザインをpill型（丸みのある背景）に改善
   - マイミールタブ: サムネイル付きリスト、「食事を作成」「以前の食事をコピー」のクイックアクション
   - マイフードタブ: 栄養素グリッド表示、編集・削除・追加ボタン
   - より使いやすく、機能が統合された一貫性のあるUIに改善

### 2025-10-18
**ホーム画面のMyFitnessPal風デザイン改善完了、運動記録画面のUI改善**

#### 更新された設計書
- `02_screen_design.md`: SCR-03（ホームダッシュボード）、SCR-06（運動記録）、SCR-02（初期設定ウィザード）

#### 主な変更内容（ホーム画面ヘッダー）
1. **ロゴとアイコンの改善**（SCR-03）
   - ロゴサイズを大きく（text-xl）
   - 緑のりんごアイコン（🍏）をロゴの左側に追加
   - 通知アイコンを設定アイコン（Settings）に変更

2. **日付ナビゲーション背景色変更**（SCR-03）
   - 日付ナビゲーション部分の背景色をbg-gray-50に戻してヘッダーとの統一感を維持

3. **カード背景色の統一**（SCR-03）
   - カルーセル内のカロリーカード、主要栄養素カードは白背景（bg-white）
   - 体重カードは白背景（bg-white）
   - 今日のタスクカードは白背景（bg-white）
   - ページ全体の背景をbg-primary/5（薄い緑）に変更
   - ヘッダーとカードは白、その周りの背景が薄い緑で、視覚的な階層構造を明確化
   - ブランドカラーを活かした一貫性のあるデザインに改善

4. **食事記録・運動記録のUI改善**（SCR-04、SCR-06）
   - 日次サマリーカードの背景色をbg-primary/10（濃いめの緑）に変更し、視認性を向上
   - カロリーの単位に「kcal」を明記
   - タンパク質と炭水化物のラベルに「whitespace-nowrap」を適用し、スマホ画面での2行折り返しを防止
   - より読みやすく、情報が一目で把握できるUIに改善

5. **食品選択ページのタブ整理**（SCR-04）
   - 「マイレシピ」タブを削除してシンプルな構成に
   - タブ切替: すべて | マイミール | マイフード（3タブ構成）
   - より分かりやすく、使いやすいUIに改善

6. **ボトムナビゲーションバーの順番変更**（共通UI）
   - タブの順番を左から「運動、食事、ホーム、分析、チャット」に変更
   - より直感的な配置に改善（ホームを中央に配置）

7. **分析ページの目標進捗カードUI改善**（SCR-07）
   - 目標進捗カードの背景色を白（bg-white）に変更
   - より明確で読みやすい表示に改善

#### 主な変更内容（ホーム画面）
1. **カルーセル式ダッシュボード**（SCR-03）
   - カロリーカードと主要栄養素カードを左右スワイプで切り替え可能
   - 両カードの高さをh-[340px]で統一し、視覚的な一貫性を確保
   - ページネーションドットで現在位置を表示

2. **日付ナビゲーション改善**（SCR-03）
   - ChevronLeft/ChevronRightアイコンで前後の日付に移動可能
   - 「今日」「昨日」「明日」を自動判定して表示

3. **カロリー表示の改善**（SCR-03）
   - 円形プログレス表示（w-36 h-36）
   - カロリー計算式を「残り = 目標摂取 - 食事摂取」に変更
   - エクササイズ分を表示から除外

4. **主要栄養素カードのレイアウト改善**（SCR-03）
   - 「脂肪」→「脂質」に表記を変更
   - 各栄養素の円形プログレス（w-24 h-24）の真下に「残り」テキストを配置
   - gap-6で適切な余白を確保し、3列のレイアウトを整理

#### 主な変更内容（運動記録画面）
1. **運動の種類更新**（SCR-06）
   - ランニング、ウォーキング、サイクリング、スイミング
   - ウェイトトレーニング（高強度）、ウェイトトレーニング（低強度）
   - ヨガ/ピラティス
   - その他（消費カロリーを自由入力）

2. **UI改善**（SCR-06）
   - 消費カロリーの背景色をbg-white border-primary/20に変更し、視認性を向上
   - 「人気の運動」セクションを削除してシンプルなUIに
   - 「その他」選択時に消費カロリーを自由入力できる機能を追加
   - 「その他」選択時は強度選択を非表示にして入力フローを最適化

#### 主な変更内容（進捗・分析画面）
1. **月次レビューの配置変更**（SCR-07）
   - 月次レビューをページの最上部に移動
   - AIによる提案とアドバイスを最初に確認できるよう改善
   - ユーザーが進捗確認時に最初にAI分析結果を見ることで、モチベーション向上を図る

#### 主な変更内容（初期設定ウィザード）
1. **TDEE計算の詳細化**（SCR-02）
   - 単一の「活動レベル」選択から5つの詳細な質問項目に拡張
   - **仕事の活動レベル**: デスクワーク/立ち仕事/動き回る/肉体労働
   - **週の運動頻度**: なし/週1-2/週3-4/週5-6/毎日
   - **運動時間**: 30分未満/30-60分/60-90分/90分以上（運動する場合のみ表示）
   - **運動の強度**: 軽い/中程度/激しい（運動する場合のみ表示）
   - **日常の移動量**: ほぼ座っている/少し歩く/そこそこ歩く/よく歩く
   - より正確なTDEE（Total Daily Energy Expenditure）計算が可能に
   - 運動頻度が「運動しない」の場合、運動時間と強度の質問を非表示にする条件付き表示を実装

### 2025-10-17
**食事記録・運動記録の日毎管理とAI写真推定UI改善**

#### 更新された設計書
- `02_screen_design.md`: SCR-03, SCR-04, SCR-06, SCR-07
- `04_database_design.md`: meals, meal_items, exercise_logs
- `06_features_detail.md`: F-03, F-05, F-06

#### 主な変更内容
1. **体重記録機能**（F-06）
   - ダッシュボード簡易入力（Collapsible）
   - 進捗ページ詳細入力（Popover + Calendar）
   - 記録履歴セクション追加

2. **食事記録の日毎管理**（F-03）
   - 日付ナビゲーション追加
   - 食事種別セクション管理（朝食・昼食・夕食・間食）
   - データ構造変更（`date`フィールド、`MealItem`配列）

3. **食事記録UI改善**（F-03）
   - 食品選択画面（FoodSelectionPage）新規作成
   - AI写真推定専用ページ（AiPhotoEstimatePage）新規作成
   - MyFitnessPal風の3画面構成

4. **運動記録の日毎管理**（F-05）
   - 日付ナビゲーション追加
   - 運動リスト表示
   - データ構造変更（`date`フィールド、`notes`追加）

詳細はGuidelines.mdの変更履歴セクションおよび各設計書の更新箇所をご参照ください。

---

### 2025-10-17 (初版)
初版作成、ドキュメントを分野別に分割
